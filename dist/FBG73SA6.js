import{D as l}from"./DSVEVIWB.js";async function u(e,i){let t=await fetch(`https://aisec.akamai.com/fai/v1/fai-configurations/${l.AI_FIREWALL_CONFIG_ID}/detect`,{method:"POST",headers:{"Content-Type":"application/json","Fai-Api-Key":l.AI_FIREWALL_KEY},body:JSON.stringify({clientRequestId:crypto.randomUUID(),llmInput:e})}),o=await t.text();if(i.log.debug({status:t.status,statusText:t.statusText,body:o}),t.status!==200)throw new Error(`AI Firewall request failed. Status: ${t.status}, status text: ${t.statusText}`);return JSON.parse(o)}async function p(e,i,t,o,s){try{let r=(await u(e,s)).rulesTriggered.filter(a=>a.action==="deny");if(r.length===0)return e;t.send(`AI Firewall has denied forwarding this incoming message. ${r[0].message} (Rule: ${r[0].ruleId})`);return}catch(n){s.log.error(n)}return e}async function y(e,i,t,o,s){try{let r=(await u(e,s)).rulesTriggered.filter(a=>a.action==="deny");if(r.length===0)return e;i.send(`AI Firewall has denied forwarding the outgoing message. ${r[0].message} (Rule: ${r[0].ruleId})`);return}catch(n){s.log.error(n)}return e}export{p as inboundFirewallPolicy,y as outboundFirewallPolicy};
//# sourceMappingURL=FBG73SA6.js.map
